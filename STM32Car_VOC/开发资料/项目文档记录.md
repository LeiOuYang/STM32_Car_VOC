# 车载项目资源说明

### GPS模块

​    合宙Air530 GPS模块。

### TVOC气体传感器模块

​    深圳慧联智控  KQM2800TA

### 温湿度传感器

​    广州奥松电子  DHT11电容式温湿度传感器模块

### 物联网开发板

​     机智云固件  物联网开发板G510

### 硬件资源分配

- 串口1  --  115200bps，连接gizwits机智云开发模块，Debug打开，数据通过串口2输出

- 串口2  --  9600bps 接收TVOC传感器数据和发送串口显示屏数据，DEBUG打开，数据通过串口1输出

- 串口3  --  38400bps  GPS接收数据解析,DEBUG打开是对应串口1输出GPS原始数据

- 模拟单总线  --  DHT11

- 三极管控制  --  蜂鸣器、RGB灯开关

  

# 机智云模块通信过程

1. **上电握手一次**

   通信模组向MCU设备发送获取设备信息指令

   ​	FF FF 00 05 01 01 00 00 07    cmd=0x01

   MCU设备返回设备信息至通信模组：产品标志码，产品密钥等设备信息

   ​	FF FF 00 6F 02 01 00 00 30 30 30 30 30 30 30 34 30 30 30 30 30 30 30 34 30 30 30 30 30 30 30 36 30 30 30 30 30 30 30 35 32 32 33 62 34 62 38 37 34 63 39 66 34 31 38 38 61 30 30 35 34 61 32 33 61 38 37 31 31 63 35 63 00 00 00 00 00 00 00 00 00 02 63 63 36 35 65 66 35 65 61 30 30 30 34 31 61 32 39 36 61 37 39 38 37 61 64 64 64 37 36 62 63 35 CF      cmd=0x02

   ​      FF FF 00 6F 02 01 00 00 30 30 30 30 30 30 30 34 30 30 30 30 30 30 30 34 30 30 30 30 30 30 30 36 30 30 30 30 30 30 30 35 32 32 33 62 34 62 38 37 34 63 39 66 34 31 38 38 61 30 30 35 34 61 32 33 61 38 37 31 31 63 35 63 00 00 00 00 00 00 00 00 00 02 63 63 36 35 65 66 35 65 61 30 30 30 34 31 61 32 39 36 61 37 39 38 37 61 64 64 64 37 36 62 63 35 CF 

2. **通信模组会定期（每十分钟）或当通信模组工作状态发生改变时，会下传状态至MCU**

​        FF FF 00 07 0D 02 00 00 00 1A 30     cmd=0x0D

   3.**MCU设备应答收到状态信息**

​	FF FF 00 05 0E 02 00 00 15         cmd=0x0E

   4.**模组成功连接上机智云服务器，则发送心跳包，MCU收到心跳包，则需回复通信模组**

​	通信模组心跳包： FF FF 00 05 07 09 00 00 15    cmd=0x07

​	MCU回复心跳包：FF FF 00 05 08 09 00 00 16    cmd=0x08

5. **有效数据传输**

   - **通讯模组获取MCU设备状态（打开app成功连接通信模组时会发送）**

     FF FF 00 08 03 0D 00 00 12 FF FF 28        cmd=0x03   action=0x12

     MCU上报状态

     FF FF 00 33 04 0D 00 00 13 FF 55 FF 55 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 55 

     

     FF FF 00 35 04 06 00 00 13 01 FF 55 FF 55 00 00 00 01 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 00 00 DA 

     

     

     cmd=0x04       action=0x13

   - **通讯模组控制设备**

     FF FF 00 09 03 1B 00 00 11 00 01 01 3A     cmd=0x03   action=0x11

     FF FF 00 09 03 44 00 00 11 00 01 00 62 

     MCU设备回复

     FF FF 00 05 04 22 00 00 2B       cmd=0x04

   - **MCU设备上报数据**

     FF FF 00 09 05 26 00 00 14 00 00 00 48   cmd=0x05   action=0x14

     

     FF FF 00 35 05 08 00 00 14 01 FF 55 FF 55 00 00 00 02 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F 20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 00 00 DF 

     

     模组回复MCU设备

     FF FF 00 05 06 26 00 00 31     cmd=0x06   

     

     **注意：数据帧中0xFF后面自动添加的0x55不包含在包长度中，也不参与校验和计算。**

     